<?php
/*
 * Copyright 2008,2009 Michinobu Maeda.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

//  出力パスの設定

define("PATH_HTML", PATH_DATA . "/html");
define("PATH_MOBILE", PATH_DATA . "/m");

// HTML に表示する件数の目安

define("LINES_HTML", 2000);
define("LINES_MOBILE", 50);

// 事業所の分類
define("KAISHA_TITLE",   "会社");
define("KINYU_TITLE",    "金融");
define("KINYU_INCLUDE",  "銀行|信用金庫|信用組合|中央金庫|証券|證券|相互会社|保険|生命");
define("KINYU_EXCLUDE",  "協会|基金|社会保険|健康保険");
define("EISUKANA_TITLE", KAISHA_TITLE."(英数かな)");
define("KANJI_TITLE",    KAISHA_TITLE."(漢字)");
define("KAISHA_INCLUDE", "会社|\(株\)|新聞社|支社|會社|本店|支店");
define("KABUSIKIGAISYA", "\(株\)|株式会社|株式會社");
define("KOKYO_TITLE",    "公共");
define("BUNKYO_TITLE",   "文教");
define("BUNKYO_INCLUDE", "大学|学校|図書館|博物館|美術館");
define("BUNKYO_EXCLUDE", KAISHA_INCLUDE);
define("IRYO_TITLE",     "医療");
define("IRYO_INCLUDE",   "病院|医院|診療所|療養所|医療法人");
define("KANTYO_TITLE",   "官庁");
define("KANTYO_INCLUDE", "省|庁|内閣|役所|役場|支所|警察|局|教育委員会|裁判所|署|税事務所|行政法人");
define("KANTYO_EXCLUDE", "放送局|事務局|組合|郵便局|機関紙局|出版局");
define("KANTYO_INC_EX1", "社会保険事務所|社会保険事務局");
define("MISC_TITLE",     "その他の事業所");
define("ZENKAKU_KATAKANA", "ア|イ|ウ|エ|オ|カ|キ|ク|ケ|コ|サ|シ|ス|セ|ソ|タ|チ|ツ|テ|ト|ナ|ニ|ヌ|ネ|ノ|ハ|ヒ|フ|ヘ|ホ|マ|ミ|ム|メ|モ|ヤ|ユ|ヨ|ラ|リ|ル|レ|ロ|ワ|ヲ|ン|ガ|ギ|グ|ゲ|ゴ|ザ|ジ|ズ|ゼ|ゾ|ダ|ヂ|ヅ|デ|ド|バ|ビ|ブ|ベ|ボ|パ|ピ|プ|ペ|ポ|ヴ");
define("ZENKAKU_HIRAGANA", "あ|い|う|え|お|か|き|く|け|こ|さ|し|す|せ|そ|た|ち|つ|て|と|な|に|ぬ|ね|の|は|ひ|ふ|へ|ほ|ま|み|む|め|も|や|ゆ|よ|ら|り|る|れ|ろ|わ|を|ん|が|ぎ|ぐ|げ|ご|ざ|じ|ず|ぜ|ぞ|だ|ぢ|づ|で|ど|ば|び|ぶ|べ|ぼ|ぱ|ぴ|ぷ|ぺ|ぽ");

$yomikubun = array(
	"@" => array("",    "/(イカニケイサイガナイバアイ|クルバアイ)$/"),
	"a" => array("ア行", "/^(ア|イ|ウ|エ|オ)/"),
	"k" => array("カ行", "/^(カ|キ|ク|ケ|コ|ガ|ギ|グ|ゲ|ゴ)/"),
	"s" => array("サ行", "/^(サ|シ|ス|セ|ソ|ザ|ジ|ズ|ゼ|ゾ)/"),
	"t" => array("タ行", "/^(タ|チ|ツ|テ|ト|ダ|ヂ|ヅ|デ|ド)/"),
	"n" => array("ナ行", "/^(ナ|ニ|ヌ|ネ|ノ)/"),
	"h" => array("ハ行", "/^(ハ|ヒ|フ|ヘ|ホ|バ|ビ|ブ|ベ|ボ|パ|ピ|プ|ペ|ポ)/"),
	"m" => array("マ行", "/^(マ|ミ|ム|メ|モ)/"),
	"x" => array("その他", "/./"),
);

$yomikubun_s = array(
	"@" => array("",    "@"),
	"a" => array("ア・カ行", "a"),
	"k" => array("ア・カ行", "a"),
	"s" => array("サ・タ・ナ行", "s"),
	"t" => array("サ・タ・ナ行", "s"),
	"n" => array("サ・タ・ナ行", "s"),
	"h" => array("その他", "x"),
	"m" => array("その他", "x"),
	"x" => array("その他", "x"),
);

// 都道府県一覧ページのテンプレート

define("HTML_INDEX", <<<EOS
<!-- HTML_BEGIN -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <link href="../htmldata.css" rel="stylesheet" type="text/css" />
    <title>郵便番号検索・一覧</title>
  </head>
  <body>
    <div id="header">
      <div id="bc">
        毎月更新、携帯とPCから
      </div>
<!-- HTML_END --
    global \$x0401;
    \$ts = date("Y-m-d H:i:s");
  -- HTML_BEGIN -->
      <div id="update">更新: \$ts</div>
      <h1>郵便番号検索・一覧</h1>
    </div>
    <div id="body">
<!-- HTML_END --
    foreach (\$states as \$state_name => \$pref_list) {
  -- HTML_BEGIN -->
      <div class="state">\$state_name
<!-- HTML_END --
        foreach (\$pref_list as \$pref_code => \$pref_name) {
  -- HTML_BEGIN -->
        <div class="pref"><a href="\$pref_code/index.html">\$pref_name</a></div>
<!-- HTML_END --
        }
  -- HTML_BEGIN -->
      </div>
<!-- HTML_END --
    }
  -- HTML_BEGIN -->
    </div>
    <div id="footer">
      Generated by <a href="http://www.zippyzip.jp/">zippyzip</a>
    </div>
  </body>
</html>
<!-- HTML_END -->
EOS
);

// 都道府県のページのテンプレート

define("PREF_INDEX", <<<EOS
<!-- HTML_BEGIN -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <link href="../../htmldata.css" rel="stylesheet" type="text/css" />
    <title>\$pref_name</title>
  </head>
  <body>
    <div id="header">
      <div id="bc">
        <a href="../index.html">郵便番号検索・一覧</a>
      </div>
<!-- HTML_END --
    \$ts = date("Y-m-d H:i:s");
  -- HTML_BEGIN -->
      <div id="update">更新: \$ts</div>
      <h1>\$pref_name</h1>
    </div>
    <div id="body">
<!-- HTML_END --
    \$group = "";
    foreach (\$x0402 as \$city_code => \$city_name) {
        if(substr(\$city_code, 0, 2) != \$pref_code) { continue; }
        \$matches = array();
        \$cnt = preg_match("/(区|市)$/", \$city_name, \$matches);
        \$sufix = (\$cnt > 0) ? \$matches[0] : "";
        if (\$group != \$sufix) {
            if (\$group != "") {
  -- HTML_BEGIN -->
      </div>
<!-- HTML_END --
            }
                \$group = \$sufix;
  -- HTML_BEGIN -->
      <div class="group">
<!-- HTML_END --
        }
        \$html_name = substr(\$city_code, 2, 3);
  -- HTML_BEGIN -->
<div class="city"><a href="\$html_name.html">\$city_name</a></div>
<!-- HTML_END --
    }
  -- HTML_BEGIN -->
      </div>
    </div>
    <div id="footer">
      Generated by <a href="http://www.zippyzip.jp/">zippyzip</a>
    </div>
  </body>
</html>
<!-- HTML_END -->
EOS
);

// 市区町村のページのテンプレート

define("CITY_DETAIL", <<<EOS
<!-- HTML_BEGIN -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <link href="../../htmldata.css" rel="stylesheet" type="text/css" />
    <title>\$city_name \$pref_name</title>
  </head>
  <body>
    <div id="header">
      <div id="bc">
        <a href="../index.html">郵便番号検索・一覧</a>
        <a href="./index.html">\$pref_name</a>
      </div>
<!-- HTML_END --
    \$ts = date("Y-m-d H:i:s");
  -- HTML_BEGIN -->
      <div id="update">更新: \$ts</div>
      <h1>\$city_name</h1>
    </div>
    <div id="body">
<!-- HTML_END --
    if ((0 < count(\$firmindex)) && (0 == count(\$yomiindex))) {
  -- HTML_BEGIN -->
      <div id="appendix">
<!-- HTML_END --
        foreach (\$firmindex as \$ix) {
  -- HTML_BEGIN -->
        <a href="{\$ix['url']}">{\$ix['ttl']}</a>
<!-- HTML_END --
        }
  -- HTML_BEGIN -->
      </div>
<!-- HTML_END --
    }
    foreach (\$areas as \$item) {
        if ((0 < count(\$yomiindex)) && (\$yomi_key != \$item['yomi'])) { continue; }
        if (isset(\$item['link'])) {
  -- HTML_BEGIN -->
<div class="item"><a href="{\$item['link']}">{\$item['add1']}</a></div>
<!-- HTML_END --
        } else {
  -- HTML_BEGIN -->
<div class="item">{\$item['zip']} {\$item['add1']} {\$item['add2']}</div>
<!-- HTML_END --
        }
    }
    if ((0 < count(\$yomiindex))) {
  -- HTML_BEGIN -->
      <div id="yomiindex">
<!-- HTML_END --
        foreach (\$yomiindex as \$key => \$ttl) {
  -- HTML_BEGIN -->
        <a href="\$file_name-\$key.html">\$ttl</a>
<!-- HTML_END --
        }
  -- HTML_BEGIN -->
      </div>
<!-- HTML_END --
    }
    if ((0 < count(\$firmindex)) && (0 < count(\$yomiindex))) {
  -- HTML_BEGIN -->
      <div id="appendix">
<!-- HTML_END --
        foreach (\$firmindex as \$ix) {
  -- HTML_BEGIN -->
        <a href="{\$ix['url']}">{\$ix['ttl']}</a>
<!-- HTML_END --
        }
  -- HTML_BEGIN -->
      </div>
<!-- HTML_END --
    }
    if ((0 == count(\$firmindex)) && (0 < count(\$firms))) {
  -- HTML_BEGIN -->
      <h2>事業所</h2>
<!-- HTML_END --
        foreach (\$firms as \$item) {
  -- HTML_BEGIN -->
<div class="item">{\$item['zip']} {\$item['add1']} {\$item['add2']} {\$item['bldg']}</div>
<!-- HTML_END --
        }
    }
  -- HTML_BEGIN -->
    </div>
    <div id="footer">
      Generated by <a href="http://www.zippyzip.jp/">zippyzip</a>
    </div>
  </body>
</html>
<!-- HTML_END -->
EOS
);

// 五十音別ページのテンプレート

define("CITY_YOMI", <<<EOS
<!-- HTML_BEGIN -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <link href="../../htmldata.css" rel="stylesheet" type="text/css" />
    <title>\$city_name \$pref_name</title>
  </head>
  <body>
    <div id="header">
      <div id="bc">
        <a href="../index.html">郵便番号検索・一覧</a>
        <a href="./index.html">\$pref_name</a>
        <a href="./{\$file_name}.html">\$city_name</a>
      </div>
<!-- HTML_END --
    \$ts = date("Y-m-d H:i:s");
  -- HTML_BEGIN -->
      <div id="update">更新: \$ts</div>
      <h1>\$yomi_ttl</h1>
    </div>
    <div id="body">
<!-- HTML_END --
    foreach (\$areas as \$item) {
        if (\$yomi_key != \$item['yomi']) { continue; }
        if (isset(\$item['link'])) {
  -- HTML_BEGIN -->
<div class="item"><a href="{\$item['link']}">{\$item['add1']}</a></div>
<!-- HTML_END --
        } else {
  -- HTML_BEGIN -->
<div class="item">{\$item['zip']} {\$item['add1']} {\$item['add2']}</div>
<!-- HTML_END --
        }
    }
  -- HTML_BEGIN -->
    </div>
    <div id="footer">
      Generated by <a href="http://www.zippyzip.jp/">zippyzip</a>
    </div>
  </body>
</html>
<!-- HTML_END -->
EOS
);

// ビル各階層のページのテンプレート

define("FLOORS_DETAIL", <<<EOS
<!-- HTML_BEGIN -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <link href="../../htmldata.css" rel="stylesheet" type="text/css" />
    <title>{\$floors[0]['add1']} \$city_name \$pref_name</title>
  </head>
  <body>
    <div id="header">
      <div id="bc">
        <a href="../index.html">郵便番号検索・一覧</a>
        <a href="./index.html">\$pref_name</a>
        <a href="./\$file_name.html">\$city_name</a>
      </div>
<!-- HTML_END --
    \$ts = date("Y-m-d H:i:s");
  -- HTML_BEGIN -->
      <div id="update">更新: \$ts</div>
      <h1>{\$floors[0]['add1']}</h1>
    </div>
    <div id="body">
<!-- HTML_END --
    foreach (\$floors as \$item) {
  -- HTML_BEGIN -->
<div class="item">{\$item['zip']} {\$item['add2']}</div>
<!-- HTML_END --
    }
  -- HTML_BEGIN -->
    </div>
    <div id="footer">
      Generated by <a href="http://www.zippyzip.jp/">zippyzip</a>
    </div>
  </body>
</html>
<!-- HTML_END -->
EOS
);

// 事業所ページのテンプレート

define("FIRM_DETAIL", <<<EOS
<!-- HTML_BEGIN -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <link href="../../htmldata.css" rel="stylesheet" type="text/css" />
    <title>\$title \$city_name \$pref_name</title>
  </head>
  <body>
    <div id="header">
      <div id="bc">
        <a href="../index.html">郵便番号検索・一覧</a>
        <a href="./index.html">\$pref_name</a>
        <a href="./\$file_name.html">\$city_name</a>
      </div>
<!-- HTML_END --
    \$ts = date("Y-m-d H:i:s");
  -- HTML_BEGIN -->
      <div id="update">更新: \$ts</div>
      <h1>\$title</h1>
    </div>
    <div id="body">
<!-- HTML_END --
    foreach (\$category as \$cat => \$cnt) {
        if (\$cnt == 0) { continue; }
        if (1 < count(\$category)) {
  -- HTML_BEGIN -->
<h2>{\$cat}</h2>
<!-- HTML_END --
        }
        foreach (\$firms as \$item) {
            if (\$item['category'] != \$cat) { continue; }
  -- HTML_BEGIN -->
<div class="item"><a href="{\$item['zip']}.html">{\$item['bldg']}</a></div>
<!-- HTML_END --
        }
    }
  -- HTML_BEGIN -->
    </div>
    <div id="footer">
      Generated by <a href="http://www.zippyzip.jp/">zippyzip</a>
    </div>
  </body>
</html>
<!-- HTML_END -->
EOS
);

// 事業所１件分のテンプレート

define("FIRM_ADDRESS", <<<EOS
<!-- HTML_BEGIN -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <link href="../../htmldata.css" rel="stylesheet" type="text/css" />
    <title>{\$item['bldg']} \$city_name \$pref_name</title>
  </head>
  <body>
    <div id="header">
      <div id="bc">
        <a href="../index.html">郵便番号検索・一覧</a>
        <a href="./index.html">\$pref_name</a>
        <a href="./\$file_name.html">\$city_name</a>
      </div>
<!-- HTML_END --
    \$ts = date("Y-m-d H:i:s");
  -- HTML_BEGIN -->
      <div id="update">更新: \$ts</div>
      <h1>事業所詳細</h1>
    </div>
    <div id="body">
      <div>{\$item['zip']}</div>
      <div>\$pref_name \$city_name {\$item['add1']} {\$item['add2']}</div>
      <div>{\$item['bldg']}</div>
    </div>
    <div id="footer">
      Generated by <a href="http://www.zippyzip.jp/">zippyzip</a>
    </div>
  </body>
</html>
<!-- HTML_END -->
EOS
);

$states = array(
    "北海道・東北" => array(
        "01" => "北海道",
        "02" => "青森県",
        "03" => "岩手県",
        "04" => "宮城県",
        "05" => "秋田県",
        "06" => "山形県",
        "07" => "福島県",
    ),
    "関東・甲信越" => array(
        "08" => "茨城県",
        "09" => "栃木県",
        "10" => "群馬県",
        "11" => "埼玉県",
        "12" => "千葉県",
        "13" => "東京都",
        "14" => "神奈川県",
        "15" => "新潟県",
        "19" => "山梨県",
        "20" => "長野県",
    ),
    "中部"=> array(
        "16" => "富山県",
        "17" => "石川県",
        "18" => "福井県",
        "21" => "岐阜県",
        "22" => "静岡県",
        "23" => "愛知県",
        "24" => "三重県",
    ),
    "近畿"     => array(
        "25" => "滋賀県",
        "26" => "京都府",
        "27" => "大阪府",
        "28" => "兵庫県",
        "29" => "奈良県",
        "30" => "和歌山県",
    ),
    "中国・四国"  => array(
        "31" => "鳥取県",
        "32" => "島根県",
        "33" => "岡山県",
        "34" => "広島県",
        "35" => "山口県",
        "36" => "徳島県",
        "37" => "香川県",
        "38" => "愛媛県",
        "39" => "高知県",
    ),
    "九州・沖縄" => array(
        "40" => "福岡県",
        "41" => "佐賀県",
        "42" => "長崎県",
        "43" => "熊本県",
        "44" => "大分県",
        "45" => "宮崎県",
        "46" => "鹿児島県",
        "47" => "沖縄県",
    ),
);

